# Діагностика проблеми з Telegram ботом

## Проблема
Повідомлення з форми замовлення не приходять в Telegram.

## Кроки для вирішення

### 1. Перезапустіть сервер розробки

**Важливо:** Next.js не перезавантажує змінні оточення автоматично. Після додавання Chat ID в `.env.local` потрібно перезапустити сервер.

```bash
# Зупиніть поточний сервер (Ctrl+C)
# Потім запустіть знову:
npm run dev
```

### 2. Перевірте .env.local

Файл має містити:
```env
TELEGRAM_BOT_TOKEN=8555898660:AAGACcEFsN5akhBXgtBUowjscQpZl28CMJ8
TELEGRAM_CHAT_ID=1629713993
```

### 3. Перевірте, що запущений правильний проект

На `localhost:3000` має відображатися сайт **Top Home Shop** з формою замовлення ковдри, а не SurveyRidge.

Якщо ви бачите інший сайт:
- Зупиніть всі процеси на порту 3000
- Запустіть наш проект: `npm run dev`

### 4. Перевірте логи сервера

Після відправки форми перевірте консоль сервера - там мають бути логи:
```
=== Telegram API Debug ===
Bot Token: ✅ Налаштовано
Chat ID: 1629713993
Form Data: { name: '...', phone: '...', ... }
```

### 5. Тестування API вручну

Запустіть тестовий скрипт:
```bash
node scripts/test-api.js
```

Або через curl:
```bash
curl -X POST http://localhost:3000/api/telegram \
  -H "Content-Type: application/json" \
  -d '{"name":"Тест","phone":"+380501234567","size":"155*210"}'
```

### 6. Перевірте консоль браузера

Відкрийте DevTools (F12) → Console та перевірте, чи є помилки при відправці форми.

### 7. Перевірте Network вкладку

Відкрийте DevTools → Network → відправте форму → знайдіть запит до `/api/telegram` → перевірте:
- Статус відповіді (має бути 200)
- Відповідь сервера (має містити `{"success": true}`)

## Можливі проблеми та рішення

### Проблема: "Chat ID не налаштовано"
**Рішення:** Перезапустіть сервер після додавання Chat ID в `.env.local`

### Проблема: "Помилка відправки повідомлення"
**Рішення:** 
- Перевірте, що Chat ID правильний
- Перевірте, що ви написали боту в Telegram
- Запустіть: `node scripts/get-telegram-chat-id.js`

### Проблема: API повертає HTML замість JSON
**Рішення:** На localhost:3000 запущений інший проект. Зупиніть його та запустіть наш.

### Проблема: Форма не знайдена на сторінці
**Рішення:** Переконайтеся, що ви на правильному сайті (Top Home Shop, а не SurveyRidge)

## Швидка перевірка

1. ✅ Chat ID в `.env.local`: `1629713993`
2. ✅ Сервер перезапущений після додавання Chat ID
3. ✅ На localhost:3000 відображається Top Home Shop
4. ✅ Форма замовлення видима на сторінці
5. ✅ Консоль браузера не показує помилок
6. ✅ Логи сервера показують успішну відправку

Якщо всі пункти виконано, але повідомлення все ще не приходять - перевірте логи сервера на детальну інформацію про помилку.
